
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Toms468 - MetaGF</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#757575">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="grey" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#metagf.toms468" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="MetaGF" class="md-header__button md-logo" aria-label="MetaGF" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MetaGF
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Toms468
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="MetaGF" class="md-nav__button md-logo" aria-label="MetaGF" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    MetaGF
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        metagf library
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../intde/" class="md-nav__link">
        Intde
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../momi/" class="md-nav__link">
        Momi
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../sommerfeld/" class="md-nav__link">
        Sommerfeld
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Toms468
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Toms468
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468" class="md-nav__link">
    metagf.toms468
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.halfsine" class="md-nav__link">
    halfsine()
  </a>
  
    <nav class="md-nav" aria-label="halfsine()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.halfsine--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.halfsine--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.halfsine--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.isign" class="md-nav__link">
    isign()
  </a>
  
    <nav class="md-nav" aria-label="isign()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.isign--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.qsub" class="md-nav__link">
    qsub()
  </a>
  
    <nav class="md-nav" aria-label="qsub()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.qsub--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.qsuba" class="md-nav__link">
    qsuba()
  </a>
  
    <nav class="md-nav" aria-label="qsuba()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.qsuba--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.quad" class="md-nav__link">
    quad()
  </a>
  
    <nav class="md-nav" aria-label="quad()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.quad--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.quad--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.quad--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../demo/" class="md-nav__link">
        Demo
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../refs/" class="md-nav__link">
        Bibliography
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468" class="md-nav__link">
    metagf.toms468
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.halfsine" class="md-nav__link">
    halfsine()
  </a>
  
    <nav class="md-nav" aria-label="halfsine()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.halfsine--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.halfsine--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.halfsine--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.isign" class="md-nav__link">
    isign()
  </a>
  
    <nav class="md-nav" aria-label="isign()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.isign--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.qsub" class="md-nav__link">
    qsub()
  </a>
  
    <nav class="md-nav" aria-label="qsub()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.qsub--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.qsuba" class="md-nav__link">
    qsuba()
  </a>
  
    <nav class="md-nav" aria-label="qsuba()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.qsuba--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metagf.toms468.quad" class="md-nav__link">
    quad()
  </a>
  
    <nav class="md-nav" aria-label="quad()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.quad--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.quad--returns" class="md-nav__link">
    Returns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metagf.toms468.quad--rev-date-author-description" class="md-nav__link">
    Rev   Date        Author                          Description
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>Toms468</h1>

<div class="doc doc-object doc-module">

<a id="metagf.toms468"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h2 id="metagf.toms468.halfsine" class="doc doc-heading">
<code class="highlight language-python"><span class="n">halfsine</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">epsil</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></code>


</h2>


    <div class="doc doc-contents ">


<details class="func-">
  <summary>function</summary>
  <p>A Python function or method. If <code>func</code>takes many
arguments, it is integrated along the axis corresponding to the
first argument.</p>
</details>
<details class="a-">
  <summary>float</summary>
  <p>width of the half-sine contour</p>
</details>
<details class="c-">
  <summary>float</summary>
  <p>maximum height of the half-sine contour</p>
</details>
<details class="epsil">
  <summary>float</summary>
  <p>required precision in Patterson quadrature</p>
</details>
<details class="args-">
  <summary>tuple, optional</summary>
  <p>Extra arguments to pass to <code>func</code></p>
</details>
<details class="y-">
  <summary>float</summary>
  <p>The value of the integral</p>
</details>
<details class="npts-">
  <summary>integer</summary>
  <p>Number integrand evaluations.</p>
</details>
<details class="relerr-">
  <summary>float</summary>
  <p>The projected relative error achieved by Patterson quadrature</p>
</details>
<details class="icheck-">
  <summary>integer</summary>
  <p>On exit normally icheck = 0.  However, if convergence
to the accuracy requested is not achieved, icheck = 1
on exit.</p>
</details>      <p>half_sine: computes the integral of the function func(x,args)
over a half-sine contour defined by the widht <code>a</code> and height <code>c</code> using Patterson
quadrature with required precision <code>epsil</code>
y, npts, relerr, icheck  = half_sine(func, a, c, epsil, args)</p>
<h4 id="metagf.toms468.halfsine--parameters">Parameters</h4>
<h4 id="metagf.toms468.halfsine--returns">Returns</h4>
<h4 id="metagf.toms468.halfsine--rev-date-author-description">Rev   Date        Author                          Description</h4>
<p>v1    10NOV19     Ivica Stevanovic, OFCOM         First implementation</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="metagf.toms468.isign" class="doc doc-heading">
<code class="highlight language-python"><span class="n">isign</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>


</h2>


    <div class="doc doc-contents ">

      <p>Function isign(a, b) returns the value of a with the sign of b.</p>
<h4 id="metagf.toms468.isign--rev-date-author-description">Rev   Date        Author                          Description</h4>
<p>v1    10NOV19     Ivica Stevanovic, OFCOM         First implementation in python</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="metagf.toms468.qsub" class="doc doc-heading">
<code class="highlight language-python"><span class="n">qsub</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">epsil</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>


</h2>


    <div class="doc doc-contents ">

      <p>qsub</p>
<p>This function routine performs automatic integration
over a finite interval using the basic integration
algorithm quad, together with, if necessary, a non-
adaptive subdivision process.
  The call takes the form
    qqsub, npts, relerr, icheck  = qsub(f, a, b epsil, args)
and causes f(x,args) to be integrated over x in (a,b) with relative
error hopefully not exceeding epsil.  Should quad converge
(icheck=0) then qsub will return the value obtained by it;
otherwise subdivision will be invoked as a rescue
operation in a non-adaptive manner.  The argument relerr
gives a crude estimate of the actual relative error
obtained.
  The subdivision strategy is as follows:
Let the interval (a,b) be divided into 2**n panels at step
n of the subdivision process.  quad is applied first to
the subdivided interval on which quad last failed to
converge, and if convergence is now achieved the remaining
panels are integrated.  should a convergence failure occur
on any panel, the integration at that point is terminated
and the procedure repeated with n increased by 1.  The
strategy ensures that possibly delinquent intervals are
examined before work, which later might have to be
discarded, is invested in well-behaved panels.  The
process is complete when no convergence failure occurs on
any panel and the sum of the results obtained by quad on
each panel is taken as the value of the integral.
  The process is very cautious in that the subdivision of
the interval (a,b) is uniform, the fineness of which is
controlled by the success of quad.  In this way, it is
rather difficult for a spurious convergence to slip
through.
  The convergence criterion of quad is slightly relaxed
in that a panel is deemed to have been successfully
integrated if either quad converges or the estimated
absolute error committed on this panel does not exceed
epsil times the estimated absolute value of the integral
over (a,b).  This relaxation is to try to take account of
a common situation where one particular panel causes
special difficulty, perhaps due to singularity of some
type.  In this case, quad could obtain nearly exact
answers on all other panels, and so the relative error for
the total integration would be almost entirely due to the
delinquent panel.  Without this condition, the computation
might continue despite the requested relative error being
achieved.
  The outcome of the integration is indicated by icheck.
  icheck = 0 - convergence obtained without invoking
               subdivision.  This corresponds to the
               direct use of quad.
  icheck = 1 - result obtained after invoking subdivision.
  icheck = 2 - as for icheck=1 but at some point the
               relaxed convergence criterion was used.
               the risk of underestimating the relative
               error will be increased.  If necessary,
               confidence may be restored by checking
               epsil and relerr for a serious discrepancy.
  icheck negative
               if during the subdivision process the
               allowed upper limit on the number of panels
               that may be generated (presently 4096) is
               reached, a result is obtained which may be
               unreliable by continuing the integration
               without further subdivision ignoring
               convergence failures.  This occurrence is
               flagged by returning icheck with negative
               sign.
The reliability of the algorithm will decrease for large
values of epsil.  It is recommended that epsil should
generally be less than about 0.001.</p>
<h4 id="metagf.toms468.qsub--rev-date-author-description">Rev   Date        Author                          Description</h4>
<p>v1    10NOV19     Ivica Stevanovic, OFCOM         First implementation in python
                                                  translated from toms468 Fortran routine</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="metagf.toms468.qsuba" class="doc doc-heading">
<code class="highlight language-python"><span class="n">qsuba</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">epsil</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>


</h2>


    <div class="doc doc-contents ">

      <p>qsuba</p>
<p>This function routine performs automatic integration
over a finite interval using the basic integration
algorithm quad, together with, if necessary, an adaptive
subdivision process.  It is generally more efficient than
the non-adaptive algorithm qsub but is likely to be less
reliable (see Comp.J., 14, 189, 1971 ).
  The call takes the form
    result, npts, relerr, icheck = qsuba(f, a, b, epsil, arg)
and causes f(x, arg) to be integrated over x in (a,b) with relative
error hopefully not exceeding epsil.  sShould quad converge
(icheck=0) then qsuba will return the value obtained by it;
otherwise subdivision will be invoked as a rescue
operation in an adaptive manner.  The argument relerr gives
a crude estimate of the actual relative error obtained.
  The subdivision strategy is as follows:
at each stage of the process, an interval is presented for
subdivision.  (Initially this will be the whole interval
(a,b)).  The interval is halved and quad applied to each
subinterval.  Should quad fail on the first subinterval,
the subinterval is stacked for future subdivision and the
second subinterval immediately examined.  Should quad fail
on the second subinterval, the subinterval is
immediately subdivided and the whole process repeated.
Each time a converged result is obtained, it is
accumulated as the partial value of the integral.  When
quad converges on both subintervals, the interval last
stacked is chosen next for subdivision and the process
repeated.  A subinterval is not examined again once a
converged result is obtained for it, so that a spurious
convergence is more likely to slip through than for the
non-adaptive algorithm qsub.
  The convergence criterion of quad is slightly relaxed
in that a panel is deemed to have been successfully
integrated if either quad converges or the estimated
absolute error committed on this panel does not exceed
epsil times the estimated absolute value of the integral
over (a,b).  This relaxation is to try to take account of
a common situation where one particular panel causes
special difficulty, perhaps due to singularity of some
type.  In this case, quad could obtain nearly exact
answers on all other panels, and so the relative error for
the total integration would be almost entirely due to the
delinquent panel.  Without this condition, the computation
might continue despite the requested relative error being
achieved.
  The outcome of the integration is indicated by icheck.
  icheck = 0 - convergence obtained without invoking
               subdivision.  This would correspond to the
               direct use of quad.
  icheck = 1 - result obtained after invoking subdivision.
  icheck = 2 - as for icheck=1 but at some point the
               relaxed convergence criterion was used.
               the risk of underestimating the relative
               error will be increased.  If necessary,
               confidence may be restored by checking
               epsil and relerr for a serious discrepancy.
  icheck negative
               If during the subdivision process the stack
               of delinquent intervals becomes full (it is
               presently set to hold at most 100 numbers)
               a result is obtained by continuing the
               integration ignoring convergence failures
               which cannot be accommodated by the stack.
               This occurrence is flagged by returning
               icheck with negative sign.
The reliability of the algorithm will decrease for large
values of epsil.  iI is recommended that epsil should
generally be less than about 0.001.</p>
<h4 id="metagf.toms468.qsuba--rev-date-author-description">Rev   Date        Author                          Description</h4>
<p>v1    10NOV19     Ivica Stevanovic, OFCOM         First implementation in python
                                                  translated from toms468 Fortran routine</p>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="metagf.toms468.quad" class="doc doc-heading">
<code class="highlight language-python"><span class="n">quad</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">epsil</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span></code>


</h2>


    <div class="doc doc-contents ">


<details class="func-">
  <summary>function</summary>
  <p>A Python function or method to integrate. If <code>func</code>takes many
arguments, it is integrated along the axis corresponding to the
first argument.</p>
</details>
<details class="a-">
  <summary>float</summary>
  <p>Lower limit of integration</p>
</details>
<details class="b-">
  <summary>float</summary>
  <p>Upper limit of integration</p>
</details>
<details class="args-">
  <summary>tuple, optional</summary>
  <p>Extra arguments to pass to <code>func</code></p>
</details>
<details class="epsil-">
  <summary>float, optional</summary>
  <p>Relative accuracy required.  When the relative
difference of two successive formulae does not
exceed <code>epsil</code> the last formula computed is taken
as the result.</p>
</details>
<details class="result-">
  <summary>array</summary>
  <p>This array, which should be declared to have at
least 8 elements, holds the results obtained by
the 1, 3, 7, etc. point formulae.  The number of
formulae computed depends on <code>epsil</code>.</p>
</details>
<details class="k-">
  <summary>integer</summary>
  <p>result[k] holds the value of the integral to the
 specified relative accuracy.</p>
</details>
<details class="npts-">
  <summary>integer</summary>
  <p>Number integrand evaluations.</p>
</details>
<details class="icheck-">
  <summary>integer</summary>
  <p>On exit normally icheck = 0.  However, if convergence
to the accuracy requested is not achieved, icheck = 1
on exit.</p>
</details>      <p>quad</p>
<p>This subroutine attempts to calculate the integral of func(x)
over the inverval <em>a</em> to <em>b</em> with relative error not
exceeding <code>epsil</code>.
The result is obtained using a sequence of 1, 3, 7, 15, 31, 63,
127, and 255 point interlacing formulae (no integrand
evaluations are wasted) of respective degrees 1, 5, 11, 23,
47, 95, 191 and 383.  The formulae are based on the optimal
extensions of the 3-point gauss formula.  Details of
the formulae are given in 'the optimum addition of points
to quadrature formulae' by T.N.L. Patterson, Maths. Comp.
Vol 22, 847-856, 1968.</p>
<h4 id="metagf.toms468.quad--parameters">Parameters</h4>
<h4 id="metagf.toms468.quad--returns">Returns</h4>
<p>Abscissae and weights of quadrature rules are stacked in
array `p in the order in which they are needed.</p>
<h4 id="metagf.toms468.quad--rev-date-author-description">Rev   Date        Author                          Description</h4>
<p>v1    10NOV19     Ivica Stevanovic, OFCOM         First implementation in python
                                                  translated from toms468 Fortran routine</p>

    </div>

  </div>





  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../sommerfeld/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Sommerfeld" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Sommerfeld
            </div>
          </div>
        </a>
      
      
        
        <a href="../../../demo/" class="md-footer__link md-footer__link--next" aria-label="Next: Demo" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Demo
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.467223ff.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>